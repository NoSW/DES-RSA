# DES + RSA


2020ç§‹å­£å­¦æœŸä¿¡æ¯å®‰å…¨åŸç†è¯¾ç¨‹å¤§ä½œä¸š  
åˆ†ä¸¤æ¬¡ä½œä¸š

- 64ä½DESåŠ å¯†
- 128ä½RSAåŠ å¯†ï¼ˆç”¨äºåŠ å¯†DESçš„å¯†é’¥ï¼‰

## **DESåŠ å¯†çš„å®éªŒæŠ¥å‘Š**

### A. [DESç®€ä»‹](https://zh.wikipedia.org/wiki/%E8%B3%87%E6%96%99%E5%8A%A0%E5%AF%86%E6%A8%99%E6%BA%96)

**æ•°æ®åŠ å¯†æ ‡å‡†**ï¼ˆè‹±è¯­ï¼šData Encryption Standardï¼Œç¼©å†™ä¸º DESï¼‰æ˜¯ä¸€ç§[å¯¹ç§°å¯†é’¥åŠ å¯†](https://zh.wikipedia.org/wiki/å°ç¨±å¯†é‘°åŠ å¯†)[å—å¯†ç ](https://zh.wikipedia.org/wiki/å¡Šå¯†ç¢¼)ç®—æ³•ï¼Œ1976å¹´è¢«[ç¾å›½](https://zh.wikipedia.org/wiki/ç¾å›½)è”é‚¦æ”¿åºœçš„[å›½å®¶æ ‡å‡†å±€](https://zh.wikipedia.org/wiki/å›½å®¶æ ‡å‡†å±€)ç¡®å®šä¸º[è”é‚¦èµ„æ–™å¤„ç†æ ‡å‡†](https://zh.wikipedia.org/wiki/è”é‚¦èµ„æ–™å¤„ç†æ ‡å‡†)ï¼ˆFIPSï¼‰ï¼Œéšååœ¨å›½é™…ä¸Šå¹¿æ³›æµä¼ å¼€æ¥ã€‚å®ƒåŸºäºä½¿ç”¨56ä½å¯†é’¥çš„[å¯¹ç§°ç®—æ³•](https://zh.wikipedia.org/w/index.php?title=å¯†é’¥å¯†ç å­¦&action=edit&redlink=1)ã€‚è¿™ä¸ªç®—æ³•å› ä¸ºåŒ…å«ä¸€äº›[æœºå¯†](https://zh.wikipedia.org/wiki/æ©Ÿå¯†)è®¾è®¡å…ƒç´ ï¼Œç›¸å¯¹çŸ­çš„[å¯†é’¥é•¿åº¦](https://zh.wikipedia.org/wiki/å¯†é’¥é•¿åº¦)ä»¥åŠæ€€ç–‘å†…å«[ç¾å›½å›½å®¶å®‰å…¨å±€](https://zh.wikipedia.org/wiki/ç¾åœ‹åœ‹å®¶å®‰å…¨å±€)ï¼ˆNSAï¼‰çš„[åé—¨](https://zh.wikipedia.org/wiki/åé—¨)è€Œåœ¨å¼€å§‹æ—¶æœ‰äº‰è®®ï¼ŒDESå› æ­¤å—åˆ°äº†å¼ºçƒˆçš„å­¦é™¢æ´¾å¼çš„å®¡æŸ¥ï¼Œå¹¶ä»¥æ­¤æ¨åŠ¨äº†ç°ä»£çš„[å—å¯†ç ](https://zh.wikipedia.org/wiki/å¡Šå¯†ç¢¼)åŠå…¶[å¯†ç åˆ†æ](https://zh.wikipedia.org/wiki/å¯†ç åˆ†æ)çš„å‘å±•ã€‚

DESç°åœ¨å·²ç»ä¸æ˜¯ä¸€ç§å®‰å…¨çš„åŠ å¯†æ–¹æ³•ï¼Œä¸»è¦å› ä¸ºå®ƒä½¿ç”¨çš„56ä½å¯†é’¥è¿‡çŸ­ã€‚1999å¹´1æœˆï¼Œ[distributed.net](https://zh.wikipedia.org/w/index.php?title=Distributed.net&action=edit&redlink=1)ä¸[ç”µå­å‰å“¨åŸºé‡‘ä¼š](https://zh.wikipedia.org/wiki/ç”µå­å‰å“¨åŸºé‡‘ä¼š)åˆä½œï¼Œåœ¨22å°æ—¶15åˆ†é’Ÿå†…å³å…¬å¼€ç ´è§£äº†ä¸€ä¸ªDESå¯†é’¥ã€‚ä¹Ÿæœ‰ä¸€äº›åˆ†ææŠ¥å‘Šæå‡ºäº†è¯¥ç®—æ³•çš„ç†è®ºä¸Šçš„å¼±ç‚¹ï¼Œè™½ç„¶åœ¨å®é™…ä¸­éš¾ä»¥åº”ç”¨ã€‚ä¸ºäº†æä¾›å®ç”¨æ‰€éœ€çš„å®‰å…¨æ€§ï¼Œå¯ä»¥ä½¿ç”¨DESçš„æ´¾ç”Ÿç®—æ³•[3DES](https://zh.wikipedia.org/wiki/3DES)æ¥è¿›è¡ŒåŠ å¯†ï¼Œè™½ç„¶3DESä¹Ÿå­˜åœ¨ç†è®ºä¸Šçš„æ”»å‡»æ–¹æ³•ã€‚DESæ ‡å‡†å’Œ3DESæ ‡å‡†å·²é€æ¸è¢«[é«˜çº§åŠ å¯†æ ‡å‡†](https://zh.wikipedia.org/wiki/é«˜çº§åŠ å¯†æ ‡å‡†)ï¼ˆAESï¼‰æ‰€å–ä»£ã€‚å¦å¤–ï¼ŒDESå·²ç»ä¸å†ä½œä¸º[å›½å®¶æ ‡å‡†ç§‘æŠ€åä¼š](https://zh.wikipedia.org/wiki/NIST)ï¼ˆå‰å›½å®¶æ ‡å‡†å±€ï¼‰çš„ä¸€ä¸ªæ ‡å‡†ã€‚

ä½†DESä¸­é‡‡ç”¨çš„å¾ˆå¤šç­–ç•¥æ˜¯å…¶ä»–é«˜çº§ç®—æ³•åŸºç¡€ï¼Œç†Ÿæ‚‰å’ŒæŒæ¡DESçš„åŠ è§£å¯†è¿‡ç¨‹å¯¹å­¦ä¹ å’Œäº†è§£ç°ä»£å¯†ç å­¦æœ‰é‡è¦æ„ä¹‰ã€‚

### B. ç®—æ³•è¿‡ç¨‹å›¾

<img src="C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201013100726889.png" alt="image-20201013100726889" style="zoom:67%;" />

#### 1. åŠ å¯†è¿‡ç¨‹ï¼š

1. åˆå§‹åŒ–å¯†é’¥ï¼Œç”¨ä¸»å¯†é’¥ç”Ÿæˆ16ç»„å­å¯†é’¥
2. åˆå§‹æ¢ä½ï¼ˆä½¿ç”¨çŸ©é˜µ$IP[64]$ï¼‰,æŠŠè¾“å‡ºåˆ†ä¸ºä¸¤ä¸ª32bitsçš„ç»„$ï¼ˆR0, L0ï¼‰= IP(in)$
3. æŒ‰ç…§ä¸‹è¿°å¼å­ï¼Œä½¿ç”¨è½®å‡½æ•°è¿›è¡Œ16æ¬¡è¿­ä»£

$$
\begin{aligned}
&L_i=R_{i-1}\\
&R_i=L_{i-1}\oplus F(R_{i-1},K_{i-1})
\end{aligned}
$$

4. å°†ä¸¤ä¸ª32bitsçš„ç»„é‡æ–°åˆå¹¶ä¸º64bitsï¼Œç„¶åä½¿ç”¨$IP^{-1}[64]$è¿›è¡Œé€†ç½®æ¢

5. è¾“å‡ºå³ä¸º64bitsçš„å¯†æ–‡

6. åŠ å¯†è¿‡ç¨‹é‡‡ç”¨CBCæ¨¡å¼ï¼Œå³æ˜æ–‡ç»„å…ˆå’Œä¸Šä¸€ä¸ªå¯†æ–‡ç»„è¿›è¡Œå¼‚æˆ–ï¼š
   $$
   M[i] =
   \left\{
   \begin{aligned}
   &M[i] \oplus Y[i-1]&&i\geq1\\
   &M[i] \oplus IV&&i=0\\
   \end{aligned}
   \right.
   $$
   
7. 

#### 2. è§£å¯†è¿‡ç¨‹ï¼š

ä¸åŠ å¯†è¿‡ç¨‹ä¸€è‡´ã€‚åªæ˜¯å­å¯†é’¥çš„ä½¿ç”¨é¡ºåºä¸åŠ å¯†è¿‡ç¨‹ç›¸åï¼ŒåŒæ—¶æŠŠ$L,R$äº’æ¢å³å¯ï¼Œå³ï¼š
$$
\begin{aligned}
&R_i=L_{i-1}\\
&L_iR_{i-1}\oplus F(L_{i-1},K_{i-1})
\end{aligned}
$$

### C. ç¨‹åºä½¿ç”¨ï¼ˆWIN10ï¼‰

##### 1. å‘½ä»¤è¡Œæ“ä½œï¼ˆCè¯­è¨€ï¼‰ï¼š

1. åœ¨ç»ˆç«¯è¾“å…¥å¦‚ä¸‹æŒ‡ä»¤ï¼Œæ‰“å°HELP

   ```shell
   $ des.exe
   ```

   <img src="C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201021204523822.png" alt="image-20201021204523822"  />

   

2. åœ¨ç»ˆç«¯è¾“å…¥å¦‚ä¸‹æŒ‡ä»¤ï¼Œè¿è¡Œç¨‹åº

   ```shell
   $ des.exe in_file [option1] [option2] [option3] [option4] ...
   ```

   * in_file , è¾“å…¥æ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€å¥½æ˜¯ç»å¯¹è·¯å¾„
   * **[option]**, 4ç§å¯é€‰é€‰é¡¹ï¼ˆå‡å¯ä»¥å¿½ç•¥ï¼Œå¦‚å¿½ç•¥å³é€‰æ‹©é»˜è®¤è®¾ç½®ï¼‰
     * **è¾“å‡ºæ–‡ä»¶çš„è·¯å¾„**ï¼šï¼Œä½¿ç”¨`=   out_path`ã€‚é»˜è®¤æ˜¯`./encoded/åŸæ–‡ä»¶å`æˆ–è€…`./decoded/åŸæ–‡ä»¶å`
     * **åŠ /è§£å¯†ç®—æ³•**ï¼šä½¿ç”¨`0` ï¼Œ`1` ï¼Œ`2` ï¼Œ`3` ï¼Œ`4`ã€‚é»˜è®¤ä¸º`0`
     * **åŠ å¯†è¿˜æ˜¯è§£å¯†**ï¼šå‰è€…ä½¿ç”¨`e`ï¼Œåè€…ä½¿ç”¨`d`ã€‚é»˜è®¤æ˜¯`e`ï¼Œå³åŠ å¯†
     * **å¯†é’¥**ï¼šä½¿ç”¨`+ k1 + k2 + k3 `ï¼Œå¯†é’¥ä¸ªæ•°è§†ç®—æ³•ç±»å‹è€Œå®šã€‚é»˜è®¤æ˜¯æ ¹æ®ç®—æ³•ç±»å‹è‡ªåŠ¨ç”Ÿæˆç®€å•å­—æ¯æ•°å­—8Byteså³64-bitå¯†é’¥

   **ä¾‹ï¼š**

   ```
   $ des.exe .data/data1.jpg d 1 + 12345678 + 12345678 + 12345678
   ```

   ä½œç”¨ï¼šä½¿ç”¨ä¸‰ä¸ªå¯†é’¥ï¼Œå¯¹æ–‡ä»¶`.data/data1.jpg`ä½¿ç”¨ç®—æ³•`1`ï¼ˆDESEEE3ï¼‰ï¼Œè¿›è¡Œè§£å¯†ï¼Œå¹¶è®²ç»“æœæ–‡ä»¶è¾“å‡ºåˆ°é»˜è®¤è·¯å¾„`./decoded/data1.jpg`.

##### 2. ç”¨æˆ·ç•Œé¢æ“ä½œï¼šï¼ˆå…·ä½“æ“ä½œå¯è§æ¼”ç¤ºè§†é¢‘demo.mp4

1. åœ¨ç»ˆç«¯æ‰§è¡Œä¸‹è¿°å‘½ä»¤ï¼Œç¼–è¯‘Cæ–‡ä»¶ï¼ˆå¦‚å·²ç»ç¼–è¯‘ï¼Œç”Ÿæˆ.exeæ–‡ä»¶å¯å¿½ç•¥è¿™ä¸€æ­¥ï¼‰

```shell
$ make
```

â€‹	2. è¿è¡Œpythonè„šæœ¬`ui.py`ï¼Œè¿è¡Œç»“æœè¢«å¦‚ä¸‹å›¾æ‰€ç¤º

<img src="C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201029190105870.png" alt="image-20201029190105870" style="zoom:67%;" />

3. é€‰æ‹© å¹¶è¾“å…¥åŠ å¯†å‚æ•°ï¼Œä¾‹å¦‚ï¼š

   ![image-20201029190230832](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201029190230832.png)

   ![image-20201029190310374](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201029190310374.png)

åŠ å¯†ç»“æœè¾“å‡ºé¡¹ç›®ç›®å½•ä¸‹ï¼Œ/des/encoded/

è§£å¯†ç»“æœè¾“å‡ºåˆ°é¡¹ç›®å½•ï¼Œ/des/decoded/

### D. ä»£ç è¯´æ˜

#### 1. ç¯å¢ƒå·¥å…·

* æ“ä½œç³»ç»Ÿï¼š**Win10-64bit**
* ç¼–è¯‘å™¨ï¼š**gcc version 8.1.0 (x86_64-posix-seh-rev0, Built by MinGW-W64 project)** .
* ç¼–ç¨‹è¯­è¨€ï¼š**C**ã€Python

#### 2. æ–‡ä»¶ç»“æ„

```
des
    |- data  			#æ•°æ®
    	   |- data1.txt
    	   .
    	   .
    	   .
    	   |- data10.txt
    |- decoded 			#è§£å¯†åçš„æ–‡ä»¶
    |- encoded 			#åŠ å¯†åçš„æ–‡ä»¶
    |- inc				#å¤´æ–‡ä»¶
           |- des.h
           |- cmd.h           
    |- src  			#æºæ–‡ä»¶
           |- des.c
           |- cmd.c
    	   |- main.c           
    |- des.exe    		#desç¨‹åº
    |- log.txt    		#æ—¥å¿—æ–‡ä»¶
    |- makefile			#makefile
    |- demo.mp4		  #æ¼”ç¤ºè§†é¢‘
    |- ui.py   			#å›¾åƒç•Œé¢è„šæœ¬
```



#### 3.å®ç°æ€è·¯

1. **bitçº§åˆ«æ“ä½œ**

   å› ä¸ºæ˜æ–‡æ˜¯64bitä¸€ç»„ï¼Œæ•…é‡‡ç”¨äº†`unsigned long long`æ¥å­˜å‚¨ä¸€ç»„æ˜æ–‡ï¼Œå¯¹ä¸‹æ ‡ç½®æ¢ã€ç§»ä½ç­‰æ“ä½œç”¨åˆ°äº†bitçº§çš„cè¯­è¨€ä»£ç ï¼š

   ![image-20201021201958640](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201021201958640.png)

   

2. **Desè®¡ç®—å•å…ƒ**

   ![image-20201021202422384](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201021202422384.png)

   

3. **CBCæ¨¡å¼**

   ![image-20201029230542519](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201029230542519.png)

   

4. **5ç§DESç®—æ³•**

   1. DES-EEE3
   2. DES-EDE3
   3. DES-EEE2 ($K1=K3$)
   4. DES-EDE2 ($K1=K3$)

   ![image-20201021203005058](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201021203005058.png)

   

5. **ç”¨æˆ·ç•Œé¢â€”â€”å‘½ä»¤è¡Œæ“ä½œ**

   ![image-20201029231312792](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201029231312792.png)

   

   

6. **æ‰“å°æ—¥å¿—**

   åŠ /å¯†æ—¶é—´ï¼Œ å¯†é’¥ï¼Œ è¾“å…¥/é™¤è·¯å¾„ç­‰ä¿¡æ¯ï¼Œç±»ä¼¼å¦‚ä¸‹ï¼š

   ![image-20201021212313438](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201021212313438.png)

7. å›¾å½¢ç•Œé¢ï¼Œåˆ©ç”¨pyhtonçš„tkinteræ¨¡å—æ„å»ºç®€å•çš„ç”¨æˆ·ç•Œé¢è·å–å‚æ•°ï¼Œç„¶åæŠŠå‚æ•°ç»„ç»‡æˆå‘½ä»¤è¡Œå½¢å¼ï¼Œé€šè¿‡`os.system('cmd')`è¾“å…¥å‘½ä»¤è¡Œï¼Œè°ƒç”¨`des.exe`ç¨‹åºè¿›è¡Œæ‰¹é‡åŠ è§£å¯†ã€‚

   <font color=red>è¯¥pythonç¨‹åºåªæ˜¯ç”¨æ¥è·å–ç”¨æˆ·é€‰æ‹©çš„å‚æ•°ï¼Œæ¨¡æ‹Ÿå‘½ä»¤è¡Œæ“ä½œï¼Œæ‰€ä»¥å¿…é¡»ä¾èµ–äº`des.exe`æ‰èƒ½ä½¿ç”¨</font>

### E. æ€§èƒ½åˆ†æ

1. æ•ˆæœè‰¯å¥½ï¼Œå¯ä»¥ä¸€èˆ¬æ–‡ä»¶è¿›è¡ŒåŠ è§£å¯†ï¼Œç¨‹åºä¸­è®¾ç½®äº†`#define MAX_BUFF_SIZE 1024*1024*10`å³æœ€å¤§æ”¯æŒæ–‡ä»¶å¤§å°ä¸º10MBã€‚å¯¹ä¸€èˆ¬çš„.txtã€.jpgã€.mp4ç­‰æ–‡ä»¶ï¼Œå®éªŒç»“æœè‰¯å¥½ã€‚
2. é€Ÿåº¦ç†æƒ³ã€‚å®éªŒè¿‡ç¨‹ä¸­ç¨³å®šåœ¨500B/msï¼ˆè€ƒè™‘åˆ°ç¡¬ä»¶æ¡ä»¶ï¼Œä¸åŒæœºå™¨é€Ÿåº¦ä¼šä¸ä¸€æ ·ï¼Œå°æ–‡ä»¶ç•¥å¿«ï¼ˆ<1MBï¼‰ã€‚

### F. æ€»ç»“

**å¾…æ”¹è¿›ï¼š**å¯¹å¯†é’¥å’Œæ˜æ–‡çš„è¾“å…¥å±€é™äºä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œæœªå®ç°01çš„æ¯”ç‰¹åºåˆ—çš„è¾“å…¥æ¥å£ã€‚

**å®‰å…¨æ€§ï¼š**56ä½çš„å¯†é’¥ï¼ˆ64ä½ä¸­æœ‰8ä½ä½œä¸ºæ ¡éªŒä½ï¼‰å…±æœ‰$2^{56}$ç§å¯èƒ½ï¼Œå¤§çº¦æ˜¯$7.2\times10^{16}$ã€‚å¯¹äºä»Šå¤©çš„ç³»ç»Ÿï¼Œå¤šå°æœºå™¨åŒæ—¶å·¥ä½œï¼Œè›®åŠ›ç ´è§£DESæ˜¯å¯è¡Œçš„ã€‚ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡å¢åŠ å¯†é’¥é•¿åº¦ï¼Œå’ŒåŠ å¯†æ¬¡æ•°æ¥å¢å¼ºåŠ å¯†çš„ç»“æœã€‚å¦‚æŠŠå¯†é’¥é•¿ä»64-bitå¢åŠ è‡³128-bitã€‚æ‰€éœ€è›®åŠ›ç ´è§£çš„æ—¶é—´å°±ä¼šå˜ä¸ºåŸæ¥çš„$2^{64}$å€ï¼Œå¦‚æœåŸæ¥ç ´è§£éœ€è¦1å°æ—¶ï¼Œé‚£ä¹ˆç°åœ¨å¯èƒ½å°±éœ€è¦$10^{17}$å¹´ï¼3é‡DESå°±æ˜¯é€šè¿‡å¤šæ¬¡åŠ å¯†æ¥è¾¾åˆ°è¶³å¤Ÿçš„å®‰å…¨æ€§ã€‚

### G. å‚è€ƒ

ã€Šè®¡ç®—æœºå®‰å…¨ã€‹ç¬¬5ç«   

[ç»´åŸºç™¾ç§‘-èµ„æ–™åŠ å¯†æ ‡å‡†](https://zh.wikipedia.org/wiki/%E8%B3%87%E6%96%99%E5%8A%A0%E5%AF%86%E6%A8%99%E6%BA%96)

[tkinter â€” Python interface to Tcl/Tk](https://docs.python.org/3/library/tkinter.html#module-tkinter)


## RSAåŠ å¯†çš„å®éªŒæŠ¥å‘Š

----

### A. ç®€ä»‹

æœ¬æ¬¡PJå®ç°å¦‚ä¸‹å†…å®¹ï¼š

* DESçš„UIç•Œé¢(ui.py)è¾“å…¥ç”±8ä½å­—ç¬¦ä¸²æ”¹ä¸ºäº†åè¿›åˆ¶æ•°å­—ï¼ˆ$0\sim2^{64}-1$ï¼‰

* RSAæ¨¡å—
  * ç”ŸæˆRSAå¯†é’¥å¯¹
  * å¯å¯¹è¾“å…¥æ•°æ®åŠ /è§£å¯†
  * å¯å¯¹è¾“å…¥æ–‡ä»¶åŠ /è§£å¯†
* DES-RSAæ†ç»‘è„šæœ¬
  * DESç”¨æ¥åŠ å¯†æ–‡ä»¶ï¼ŒRSAç”¨æ¥åŠ å¯†DESå¯†é’¥ï¼Œä¸¤è€…æœ€ç»ˆç»„åˆæˆåŠ å¯†åçš„æ–‡ä»¶ã€‚

### B. RSAç®—æ³•è¿‡ç¨‹

1. é€‰æ‹©ä¸¤ä¸ªå¤§ç´ æ•°$p, q$

2. è®¡ç®—$n=p*q,\ \ \ \phi(n)=(p-q))(q-1)$

3. éšæœºé€‰å–æ•´æ•°$d$ä½œä¸ºç§é’¥ï¼Œæ»¡è¶³$(d,\phi(n))=1$

4. è®¡ç®—å…¬é’¥$e$ï¼Œä½¿å…¶æ»¡è¶³$e*d = 1 mod\ \phi(n)$

   åŠ å¯†ï¼š

$$
c = m^e mod\ n
$$

â€‹		è§£å¯†ï¼š
$$
m = c^d mod\ n
$$

### C. ç¨‹åºä½¿ç”¨è¯´æ˜ ï¼ˆWIN 10)

1. ä½¿ç”¨RSAåŠ å¯†ä¸€ä¸ªæ•´æ•°ï¼ˆ$0\sim2^{128}-1$ï¼‰ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼ˆæ¼”ç¤ºè§`.\rsa\demo-rsa.mp4`)

   ```shell
   $ cd rsa  # è¿›å…¥.\rsa\ç›®å½•ä¸‹ï¼Œç¡®ä¿å¯æ‰§è¡Œæ–‡ä»¶rsa.exeå·²ç»å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå¯è¿è¡Œ $ make ç¼–è¯‘è¿è¡Œç”Ÿæˆrsa.exe
   $ rsa.exe -d  å¾…åŠ å¯†çš„æ•°å­— --init  # åˆå§‹åŒ–ä¸€ä¸ªRSAå¯†é’¥å¯¹å¹¶ä½¿ç”¨è¯¥å¯†é’¥å¯¹å¯¹è¾“å…¥æ•°å­—ï¼ˆ2~37ä½åè¿›åˆ¶æ•´æ•°ï¼Œå³åœ¨128bitçš„è¡¨ç¤ºèŒƒå›´å†…ï¼‰è¿›è¡ŒåŠ å¯†
   ```

   å¦‚æœå·²ç»æœ‰RSAå¯†é’¥å¯¹å¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡ŒåŠ å¯†ï¼š

   ```shell
   $ cd rsa
   $ rsa.exe -d å¾…åŠ å¯†çš„æ•°å­— -p ä½ çš„å…¬é’¥ -m ä½ çš„æ¨¡æ•°
   ```

   è§£å¯†å‘½ä»¤ï¼š

   ```shell
   $ cd rsa 
   $ rsa.exe -d åŠ å¯†çš„ç»“æœ -s ä½ çš„å¯†é’¥ -m ä½ çš„æ¨¡æ•°
   ```

   

2. å›¾å½¢ç•Œé¢æ“ä½œï¼š(æ¼”ç¤ºè§`demo-des-rsa.mp4`)

   1. æ‰“å¼€å›¾åƒç•Œé¢ï¼ˆå³è¿è¡Œ`des-rsa.py`)

      <img src="C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127090403037.png" alt="image-20201127090403037" style="zoom:50%;" />

   2. é€‰æ‹©`Encode`å³åŠ å¯†æ¨¡å¼ï¼Œç‚¹å‡»`open file`é€‰æ‹©è¦åŠ å¯†çš„æ–‡ä»¶ï¼Œè¾“å…¥DESå¯†é’¥ï¼ˆåœ¨64bitçš„è¡¨ç¤ºèŒƒå›´å†…çš„åè¿›åˆ¶æ•°å­—ï¼‰ã€‚å¦‚æœè¦åˆå§‹åŒ–ä¸€ä¸ªRSAå¯†é’¥å¯¹ï¼Œå‹¾é€‰`init rsa`ï¼Œ ç‚¹å‡»`run`

      ![image-20201127090617263](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127090617263.png)

   3. åŠ å¯†ç»“æœä¿å­˜åœ¨`result\`ç›®å½•ä¸‹ï¼Œï¼ˆè¿™é‡ŒåŠ å¯†ç»“æœæ˜¯æœ€æ–°çš„ä¸€ä¸ªresultï¼Œä¸‹å›¾ä¸­å°±æ˜¯resut5\ç›®å½•

      ![image-20201127090926021](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127090926021.png)

   4. æ‰“å¼€åŠ å¯†ç»“æœæ–‡ä»¶å¤¹

      * `des-log.txt`,`rsa-out.txt`åˆ†åˆ«ä¿å­˜äº†DESåŠ å¯†ä¿¡æ¯ï¼ŒRSAåŠ å¯†ä¿¡æ¯ã€‚åˆå§‹åŒ–çš„RSAå¯†é’¥å¯¹å¯ä»¥åœ¨`rsa-out.txt`ä¸­æ‰¾åˆ°ï¼ˆå¦‚ä¸‹å›¾ï¼‰

        <img src="C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127091307286.png" alt="image-20201127091307286" style="zoom:67%;" />





`.result5\out\`ç›®å½•ä¸‹ä¿å­˜ äº†åŠ å¯†åçš„æ–‡ä»¶ã€‚

> â€‹	ä½¿ç”¨DES-RSAç»„åˆåŠ å¯†æ–‡ä»¶ï¼ŒRSAç”¨æ¥åŠ å¯†DESå¯†é’¥ï¼ŒDESç”¨æ¥åŠ å¯†æ–‡ä»¶ã€‚æŠŠDESå¯†é’¥çš„åŠ å¯†ç»“æœé«˜ä½è¡¥é›¶çš„æ–¹å¼å¡«å……è‡³40ä½åè¿›åˆ¶æ•°å­—ï¼ŒæŒ‰ç…§å­—ç¬¦å½¢å¼å­˜å‚¨åœ¨åŠ å¯†æ–‡ä»¶é¦–éƒ¨ï¼ŒRSAæ¨¡æ•°å¡«å……è‡³40ä½ç´§è·Ÿåœ¨åŠ å¯†åçš„DESå¯†é’¥ä¹‹åï¼Œç„¶åæ˜¯ä½¿ç”¨DESåŠ å¯†åçš„æ•°æ®ã€‚ï¼ˆå¦‚ä¸‹å›¾ï¼‰ ã€‚ä¼ è¾“æ—¶ï¼Œåªéœ€è¦æŠŠ`out\`æ–‡ä»¶å¤¹ä¼ ç»™æ‹¥æœ‰ç§é’¥çš„ç”¨æˆ·å³å¯ã€‚è¿™é‡Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œç›´æ¥ä½¿ç”¨äº†åˆå§‹åŒ–çš„RSAå¯†é’¥
>
> ```
> encoded des key][rsa module][encoded data]
> |-----40B------|----40B-----|--variable--| 
> ```
>
> ![image-20201127091350624](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127091350624.png)

  * é€‰æ‹©`Decode`, é€‰æ‹©å¾…è§£å¯†çš„æ–‡ä»¶ï¼Œåªéœ€è¦è¾“å…¥RSAç§é’¥ï¼Œç‚¹å‡»`run`
    

![image-20201127091720675](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127091720675.png)
        
* æŸ¥çœ‹è§£å¯†ç»“æœï¼Œè§£å¯†æˆåŠŸï¼
      

<img src="C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127091842702.png" alt="image-20201127091842702" style="zoom:50%;" />
      
* æ€»ç»“ï¼šåŠ å¯†éœ€è¦DESå¯†é’¥ã€RSAå…¬é’¥å’ŒRSAæ¨¡æ•°ï¼ˆæˆ–è€…init)ï¼› è§£å¯†åªéœ€è¦RSAç§é’¥

### D. ä»£ç è¯´æ˜

1. ç¯å¢ƒå·¥å…·

   * æ“ä½œç³»ç»Ÿï¼š **Win10-64bit**
   * ç¼–è¯‘å™¨ï¼š**gcc version 8.1.0 **
   * ç¼–ç¨‹è¯­è¨€ï¼š **Cã€Python**

2. Github: 

3. æ–‡ä»¶ç»“æ„

   ```
   DES-RSA
   	|- data					#æµ‹è¯•æ•°æ®
   		|- data1.txt
   		...
   		|- data10.txt
   	|- des
       	|- decoded 			#DESè§£å¯†åçš„æ–‡ä»¶
       	|- encoded 			#DESåŠ å¯†åçš„æ–‡ä»¶
       	|- inc				#DESå¤´æ–‡ä»¶
   	           |- des.h
   	           |- cmd.h           
       	|- src  			#DESæºæ–‡ä»¶
   	           |- des.c
   	           |- cmd.c
   	    	   |- main.c           
   	    |- des.exe    		#desç¨‹åº
       	|- des-log.txt    	#DESæ—¥å¿—æ–‡ä»¶
   	    |- makefile
   	    |- ui.py   			#DESå›¾åƒç•Œé¢è„šæœ¬
   	|- rsa
       	|- key 				#ä¿å­˜RSAç”Ÿæˆçš„å¯†é’¥å¯¹
       	|- out				#RSAåŠ å¯†åçš„æ–‡ä»¶
       	|- inc				#RSAå¤´æ–‡ä»¶
   	           |- cmd.h
   	           |- macro.h
                  	 |- prime.h   
                  	 |- rsa.h   
       	|- src  			#RSAæºæ–‡ä»¶
   	           |- cmd.c
   	           |- main.c
   	    	|- prime.c
                  	 |- rsa.c 
   	    |- rsa.exe    		#rsaç¨‹åº
       	|- rsa-log.txt    	#RSAæ—¥å¿—æ–‡ä»¶
   	    |- makefile
   	    |- demo-rsa.mp4		#RSAæ¼”ç¤ºè§†é¢‘
       |- des-rsa.py   		#DES-RSAå›¾åƒç•Œé¢è„šæœ¬
       |- README.md
   ```

   

4. Cè¯­è¨€å¤§æ•´æ•°è¿ç®—ä»£ç è¯´æ˜

   ä¸åŒäºDESçš„ç½®æ¢æ“ä½œï¼ŒRSAæ¶‰åŠåˆ°å¤§æ•´æ•°çš„åŠ å‡ä¹˜é™¤ä»¥åŠæ±‚å¹‚å–æ¨¡è¿ç®—ã€‚é‡‡ç”¨`_uint128_t`ä½œä¸º128bitå¤§æ•´æ•°çš„å­˜å‚¨ç±»å‹ï¼Œå¹¶é‡‡å–ä»¥ä¸‹å‡ ç‚¹åšæ³•æ¥é¿å…è¿ç®—çš„æº¢å‡º:

   1. å¯¹å¯èƒ½çš„å‡æ³•æº¢å‡ºï¼ˆäº§ç”Ÿè´Ÿæ•°ï¼‰ï¼Œé‡‡ç”¨é¢å¤–çš„å˜é‡`sign_x`æ¥ç»´æŠ¤å¤§æ•´æ•°`x`çš„ç¬¦å·ã€‚ï¼ˆå†™ä»£ç è¿‡ç¨‹ä¸­åªæœ‰å¾ˆå°çš„ä¸€éƒ¨åˆ†æ¶‰åŠå‡æ³•è¿ç®—ï¼‰

   2. å¯¹å¯èƒ½åŠ æ³•æº¢å‡ºï¼Œå¦‚`(a+b) % n`, é‡‡ç”¨`a + b - p`çš„æ–¹å¼å–æ¨¡

   3. å¯¹å¯èƒ½çš„ä¹˜æ³•æº¢å‡ºï¼Œå¦‚`(a * b)% n`,é‡‡ç”¨äºŒåˆ†æ³•çš„æ–¹å¼ï¼Œæ‹†è§£ä¸º`(a * (b/2) + a * (b/2)) % p` (å‡è®¾bæ˜¯å¶æ•°ï¼Œ å¥‡æ•°ç±»ä¼¼å¤„ç†)ï¼Œå¯¹å…¶è¿›è¡Œ$\lceil log_2b\rceil $æ¬¡åŠ æ³•è¿ç®—æ¥å®ç°ã€‚

   4. å¯¹å¯èƒ½çš„æ±‚å¹‚æº¢å‡ºï¼Œ å¦‚ `pow(a ,b) % n`,é‡‡ç”¨äºŒåˆ†æ³•çš„æ–¹å¼ï¼Œæ‹†è§£ä¸º `pow(a, b/2)  * pow(a, b/2) % n`(å‡è®¾bæ˜¯å¶æ•°ï¼Œå¥‡æ•°ç±»ä¼¼å¤„ç†)ï¼Œå¯¹å…¶è¿›è¡Œ$\lceil log_2b\rceil$æ¬¡ä¹˜æ³•è¿ç®—æ¥å®ç°ã€‚ä¹˜æ³•å†æŒ‰ç…§3.ä¸­çš„æ–¹æ³•åˆ†è§£ä¸ºåŠ æ³•è¿ç®—ã€‚æ€»å…±éœ€è¦$\lceil log_2b\rceil * \lceil log_2a\rceil $æ¬¡åŠ æ³•

   5. å¯¹äº128ä½çš„æ˜æ–‡`m`å¤§äºæ¨¡æ•°nçš„æƒ…å†µï¼Œé€šè¿‡åŠ å¯†-è§£å¯†ä¹‹åï¼Œå¹¶ä¸ä¼šè¿˜åŸåˆ°åŸæ¥çš„ `m`,è€Œæ˜¯`m % p`ï¼š

      * å¦‚æœæ˜¯ä½¿ç”¨ç»™å®šçš„å…¬é’¥å’Œæ¨¡æ•°ï¼Œå¦‚æœ`m`å¤§äºæ¨¡æ•°ï¼ŒæŠ¥é”™

      * å¦‚æœæ˜¯åˆå§‹åŒ–RSAå¯†é’¥å¯¹å¹¶å¯¹`m`åŠ å¯†ï¼Œä¼šä¸€ç›´äº§ç”Ÿå¯†é’¥å¯¹ï¼Œç›´åˆ°å¯†é’¥å¯¹çš„æ¨¡æ•°è¶³å¤Ÿå¤§èƒ½å¤Ÿå¯¹`m`åŠ å¯†ã€‚

        > ä½†`m`å…è®¸çš„æœ€å¤§å€¼å¹¶ä¸æ˜¯$2^{128}-1$ã€‚é€šè¿‡æµ‹è¯•(ä¸åœåœ°éšæœºç”Ÿæˆå¯†é’¥å¯¹ï¼Œæ‰¾åˆ°æ›´å¤§çš„æ¨¡æ•°ï¼ŒæŸ¥æ‰¾æ¬¡æ•°ä¸Šé™è®¾ä¸º1,000,000æ¬¡)ï¼ŒæŸæ¬¡æµ‹è¯•ç»“æœæ‰¾åˆ°çš„è¿‘ä¼¼æœ€å¤§æ¨¡æ•°æ˜¯`0xfebe909664ae0fd2a9ad7948b1702305`ï¼ˆå¦‚ä¸‹å›¾ï¼‰![image-20201127112000431](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127112000431.png)

   â€‹     

      * è€ƒè™‘åˆ°è¦æ±‚æ˜¯RSAç”¨äºå¯¹64bitçš„å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œè¿œå°äºæ¨¡æ•°ï¼ˆæ¨¡æ•°ä¸€èˆ¬å¤§äº$2^{127}$ï¼‰å®é™…åº”ç”¨ä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚

5. æ ¸å¿ƒä»£ç 

   1. RSAå¯†é’¥å¯¹ç”Ÿæˆ

      ![image-20201127021002153](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127021002153.png)

   2. å¤§å¥‡æ•´æ•°ç”Ÿæˆ

      * `parity`è¡¨ç¤ºç”Ÿæˆçš„æ˜¯å¥‡æ•°ã€å¶æ•°ã€è¿˜æ˜¯éšæœºã€‚
      * `flag`è¡¨ç¤ºç”Ÿæˆçš„æ˜¯å¤§æ•´æ•°ï¼ˆå¼ºåˆ¶`n_bits`æ¯”ç‰¹ä½ç½®1ï¼‰æˆ–è€…éšæœº

      ![image-20201127021306557](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127021306557.png)

   3. å¤§ç´ æ•°ç”Ÿæˆ

      ![image-20201127021410773](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127021410773.png)

   4. Jacobiç¬¦å·

      ![image-20201127022827771](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127022827771.png)

   5. ç´ æ€§æ£€æµ‹

      ![image-20201127022924570](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127022924570.png)

   6. æ¯”ç‰¹ä½ç½®0ç½®1

      ![image-20201127023016514](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127023016514.png)

### E. é€Ÿåº¦æµ‹è¯•

* Win10 64ä½æ“ä½œç³»ç»Ÿ ã€å¤„ç†å™¨i5-8300H 23.0GHz, RAM 16GB çš„æœºå™¨ä¸Šçš„ç»“æœï¼šæ¯ä¸ªäº§ç”Ÿä¸€ä¸ªå¯†é’¥å¯¹å¤§çº¦èŠ±è´¹1.1545 æ¯«ç§’ã€‚æ¯æ‰§è¡Œä¸€æ¬¡åŠ å¯†-è§£å¯† éœ€è¦4.3286æ¯«ç§’

  è¿è¡Œ

  ```shell
  $ cd rsa
  $ rsa.exe --test
  ```

  ç»“æœï¼š

![image-20201127184041899](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201127184041899.png)

â€‹		è¿è¡Œ

```shell
$ cd rsa
$ rsa.exe --speed
```
â€‹		ç»“æœï¼š

![image-20201128105056571](C:\Users\LLQ\AppData\Roaming\Typora\typora-user-images\image-20201128105056571.png)

### F. æ€»ç»“

RSAç®—æ³•ä¸­æ¶‰åŠäº†å¤§é‡çš„åŠ æ³•ã€ä¹˜æ³•è¿ç®—å’ŒDESçš„ç½®æ¢æ“ä½œç›¸æ¯”é€Ÿåº¦æ˜¾è‘—åœ°æ›´æ…¢ã€‚ä½†RSAç†è®ºä¸Šçš„è®¡ç®—å›°éš¾æ€§ä»¥åŠå…·æœ‰å…¬é’¥ä½“åˆ¶çš„ä¼˜ç‚¹ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒRSAæœ‰DESæ— æ³•æ›¿ä»£çš„ä¼˜ç‚¹ã€‚å› æ­¤RSAé€‚åˆå’ŒDESç»„åˆæ„æˆå¯†ç ç³»ç»Ÿï¼šRSAç”¨æ¥åŠ å¯†æ•°æ®é‡å°çš„DESå¯†é’¥ï¼ŒDESç”¨æ¥åŠ å¯†åŸå§‹æ•°æ®ï¼Œå¯ä»¥ä½¿å¾—å¯†ç ç³»ç»Ÿæ›´å®‰å…¨ï¼Œé€Ÿåº¦æ›´å¿«ã€‚


## **TODO**

`README.md`çš„å›¾ç‰‡ï¼ˆ **æ— å›¾ä¸€èº«è½»/ğŸ¶**  